/*
 GROUP-03
 HIMANSU RATHI 12/CS/06
 R OM PRAKASH 12/CS/07
*/

/*DROP TABLE friendbook_comment;
DROP TABLE friendbook_sizepost;
DROP TABLE friendbook_author;
*/

/* CREATION OF TABLE friendbook_author */

CREATE TABLE friendbook_author(
NAME VARCHAR(20),
ID NUMERIC(20) PRIMARY KEY,
CITY VARCHAR(120) NOT NULL,
COUNTRY VARCHAR(20) NOT NULL,
AGE NUMERIC(20) CHECK(AGE BETWEEN 16 AND 105),
GENDER VARCHAR(20) CHECK(GENDER IN ('MALE','FEMALE'))
);

/* CREATION OF TABLE friendbook_sizepost */

CREATE TABLE friendbook_sizepost(
POST VARCHAR(80),
ID NUMERIC(20) PRIMARY KEY,
POSTTYPE VARCHAR(80) CHECK(POSTTYPE IN ('PICTURE','STATUS','VIDEO')),
AUTHOR NUMERIC(20) REFERENCES friendbook_author(ID)
);

/* CREATION OF TABLE friendbook_comment */

CREATE TABLE friendbook_comment(
COMMENT VARCHAR(80),
ID NUMERIC(20) PRIMARY KEY,
COMMENTTYPE VARCHAR(80) CHECK(COMMENTTYPE IN ('PICTURE','STATUS','VIDEO')),
POST NUMERIC(20) REFERENCES friendbook_sizepost(ID),
AUTHOR NUMERIC(20) REFERENCES friendbook_author(ID)
);

/* INSERTION OF VALUES IN TABLE friendbook_author */

INSERT INTO friendbook_author
VALUES('HIMANSU',1,'KOLKATA','INDIA',20,'MALE')
INSERT INTO friendbook_author
VALUES('SHALINI',2,'CANADA','USA',25,'FEMALE')
INSERT INTO friendbook_author
VALUES('CHANRADEV',3,'DURGAPUR','INDIA',22,'MALE')
INSERT INTO friendbook_author
VALUES('DEEPAK',4,'HONGKONG','CHINA',18,'MALE')
INSERT INTO friendbook_author
VALUES('SWATI',5,'KATHMANDU','NEPAL',45,'FEMALE')
INSERT INTO friendbook_author
VALUES('DIVYA',6,'DURGAPUR','INDIA',20,'FEMALE')
INSERT INTO friendbook_author
VALUES('ABHINAV',7,'DURGAPUR','INDIA',31,'MALE')
INSERT INTO friendbook_author
VALUES('ANEESHA',8,'CANADA','USA',47,'FEMALE')
INSERT INTO friendbook_author
VALUES('ALOK',9,'NEW YORK','USA',25,'MALE')
INSERT INTO friendbook_author
VALUES('ARINATI',10,'KATHMANDU','NEPAL',18,'FEMALE')
INSERT INTO friendbook_author
VALUES('ARINDAM',11,'HONGKONG','CHINA',25,'MALE')
INSERT INTO friendbook_author
VALUES('LEENA',12,'CANADA','USA',40,'FEMALE')
INSERT INTO friendbook_author
VALUES('SHAKIRA',13,'PARIS','FRANCE',16,'FEMALE')
INSERT INTO friendbook_author
VALUES('PRIYA',14,'CANADA','USA',46,'FEMALE')
INSERT INTO friendbook_author
VALUES('KAMAL',15,'DURGAPUR','INDIA',27,'MALE')
INSERT INTO friendbook_author
VALUES('ISABELLA',16,'DURGAPUR','INDIA',48,'FEMALE')
INSERT INTO friendbook_author
VALUES('SARITA',17,'CANADA','USA',42,'FEMALE')
INSERT INTO friendbook_author
VALUES('KINGSHUK',18,'MYANMAR','BHUTAN',49,'MALE')
INSERT INTO friendbook_author
VALUES('KRISHNA',19,'KOLKATA','INDIA',41,'MALE')
INSERT INTO friendbook_author
VALUES('KRITIKA',20,'CANADA','USA',23,'FEMALE')

/* INSERTION INTO TABLE friendbook_sizepost */

INSERT INTO friendbook_sizepost
VALUES('WELCOME TO MY ACCOUNT',10,'PICTURE',1)
INSERT INTO friendbook_sizepost
VALUES('HELLO',20,'STATUS',2)
INSERT INTO friendbook_sizepost
VALUES('WONDERFUL DAY',30,'VIDEO',3)
INSERT INTO friendbook_sizepost
VALUES('BUSY TODAY',40,'STATUS',4)
INSERT INTO friendbook_sizepost
VALUES('GOODNIGHT',50,'PICTURE',5)
INSERT INTO friendbook_sizepost
VALUES('NEW_LIFE',60,'VIDEO',6)
INSERT INTO friendbook_sizepost
VALUES('CHANGED MYSELF TODAY LIKE A BOSS !!!!!!!!!!!!!!',70,'STATUS',7)
INSERT INTO friendbook_sizepost
VALUES('WORK HARD',80,'STATUS',8)
INSERT INTO friendbook_sizepost
VALUES('BEAUTIFUL LIFE, CREATURE, WORLD !!!!!!!!!!!!!!!',90,'VIDEO',9)
INSERT INTO friendbook_sizepost
VALUES('WATCH IT',100,'PICTURE',10)
INSERT INTO friendbook_sizepost
VALUES('LOVE',110,'VIDEO',11)
INSERT INTO friendbook_sizepost
VALUES('LOOK BEFORE U LEAP',120,'VIDEO',12)
INSERT INTO friendbook_sizepost
VALUES('KNOWLEDGE IS POWER',130,'STATUS',13)
INSERT INTO friendbook_sizepost
VALUES('BROKEN HEART',140,'STATUS',14)
INSERT INTO friendbook_sizepost
VALUES('MOTIVATIONAL',150,'VIDEO',15)
INSERT INTO friendbook_sizepost
VALUES('LUCKY DAY!',160,'STATUS',16)
INSERT INTO friendbook_sizepost
VALUES('MISERABLE',170,'PICTURE',17)
INSERT INTO friendbook_sizepost
VALUES('I AM PROUD OF MY COUNTRY',180,'PICTURE',18)
INSERT INTO friendbook_sizepost
VALUES('COMPUTER GEEK!!!!',190,'STATUS',19)
INSERT INTO friendbook_sizepost
VALUES('LOL',200,'VIDEO',20)
INSERT INTO friendbook_sizepost
VALUES('HELLO WORLD',210,'STATUS',8)
INSERT INTO friendbook_sizepost
VALUES('HOLIDAY',220,'STATUS',10)
INSERT INTO friendbook_sizepost
VALUES('VIRUS',230,'PICTURE',12)
INSERT INTO friendbook_sizepost
VALUES('HALUCINATION',240,'STATUS',12)
INSERT INTO friendbook_sizepost
VALUES('HEIGHTS!!!!',250,'PICTURE',12)
INSERT INTO friendbook_sizepost
VALUES('ENJOY',260,'STATUS',12)
INSERT INTO friendbook_sizepost
VALUES('HAPPY',270,'STATUS',12)
INSERT INTO friendbook_sizepost
VALUES('HOLLOW INSIDE',280,'PICTURE',12)
INSERT INTO friendbook_sizepost
VALUES('DIFFICULT TIMES',290,'STATUS',12)
INSERT INTO friendbook_sizepost
VALUES('DRUNK!',300,'STATUS',12)
INSERT INTO friendbook_sizepost
VALUES('IN PARIS',310,'STATUS',12)
INSERT INTO friendbook_sizepost
VALUES('COOKING',320,'VIDEO',12)
INSERT INTO friendbook_sizepost
VALUES('FAVOURITE PET?',330,'PICTURE',12)
INSERT INTO friendbook_sizepost
VALUES('MEMORIAL VIDEO',340,'VIDEO',12)
INSERT INTO friendbook_sizepost
VALUES('GOING TO WORKSHOP',350,'STATUS',12)
INSERT INTO friendbook_sizepost
VALUES('NICE SONG',360,'STATUS',12)
INSERT INTO friendbook_sizepost
VALUES('GREAT MOVIE',370,'STATUS',12)
INSERT INTO friendbook_sizepost
VALUES('SWEET HOME!',380,'PICTURE',12)
INSERT INTO friendbook_sizepost
VALUES('BACK IN HOME',390,'VIDEO',12)
INSERT INTO friendbook_sizepost
VALUES('NERD!',400,'VIDEO',12)
INSERT INTO friendbook_sizepost
VALUES('LOL',410,'VIDEO',12)
INSERT INTO friendbook_sizepost
VALUES('!!!!!HELLO',420,'STATUS',12)
INSERT INTO friendbook_sizepost
VALUES('HOLIDAY AGAIN',430,'STATUS',12)
INSERT INTO friendbook_sizepost
VALUES('MARRIED!',440,'VIDEO',12)
INSERT INTO friendbook_sizepost
VALUES('BUSY IN GERMANY',450,'STATUS',12)
INSERT INTO friendbook_sizepost
VALUES('ILLOGICAL STORY',460,'VIDEO',12)
INSERT INTO friendbook_sizepost
VALUES('PERFORMANCE',470,'PICTURE',12)
INSERT INTO friendbook_sizepost
VALUES('GREATEST GIFT',480,'PICTURE',12)

/* INSERTION INTO TABLE friendbook_comment */

INSERT INTO friendbook_comment
VALUES('QUITE IMPRESSIVE',10000,'PICTURE',10,1)
INSERT INTO friendbook_comment
VALUES('HAI!',20000,'STATUS',20,2)
INSERT INTO friendbook_comment
VALUES('BEAUTIFUL WEATHER',30000,'PICTURE',30,3)
INSERT INTO friendbook_comment
VALUES('TALK LATER',40000,'STATUS',40,4)
INSERT INTO friendbook_comment
VALUES('GOOD MORNING',50000,'STATUS',50,5)
INSERT INTO friendbook_comment
VALUES('LIFE AFTER DEATH!',60000,'VIDEO',60,6)
INSERT INTO friendbook_comment
VALUES('LAZY AND SLEEPY',70000,'STATUS',70,7)
INSERT INTO friendbook_comment
VALUES('A NEW BEING',80000,'STATUS',80,8)
INSERT INTO friendbook_comment
VALUES('LOVED THE VIDEO',90000,'STATUS',90,9)
INSERT INTO friendbook_comment
VALUES('DELICIOUS',100000,'STATUS',100,10)
INSERT INTO friendbook_comment
VALUES('I LOVE MYSELF',110000,'PICTURE',110,11)
INSERT INTO friendbook_comment
VALUES('REMOVE MY PIC',120000,'VIDEO',120,12)
INSERT INTO friendbook_comment
VALUES('DELICIOUS',130000,'PICTURE',130,13)
INSERT INTO friendbook_comment
VALUES('FEELING SAD',140000,'STATUS',140,14)
INSERT INTO friendbook_comment
VALUES('MUST WATCH',150000,'VIDEO',150,15)
INSERT INTO friendbook_comment
VALUES('FORTUNE ON MY SIDE',160000,'STATUS',160,16)
INSERT INTO friendbook_comment
VALUES('TERRIBLE CONDITION OF MY HOME',170000,'PICTURE',170,17)
INSERT INTO friendbook_comment
VALUES('SINGING NATIONAL ANTHEM',180000,'STATUS',180,18)
INSERT INTO friendbook_comment
VALUES('ADDICTED TO CODING',190000,'VIDEO',190,19)
INSERT INTO friendbook_comment
VALUES('LAUGHING A LOT!!!',200000,'PICTURE',200,20)
INSERT INTO friendbook_comment
VALUES('HELLO',210000,'PICTURE',210,8)
INSERT INTO friendbook_comment
VALUES('MR BEAN HOLIDAY-GREAT MOVIE!!! MUST WATCH',220000,'PICTURE',220,10)
INSERT INTO friendbook_comment
VALUES('TROJAN VIRUS ATTACKED COMPUTER',230000,'PICTURE',230,10)
INSERT INTO friendbook_comment
VALUES('FEELING DIZZY',240000,'PICTURE',240,8)
INSERT INTO friendbook_comment
VALUES('ON AN AEROPLANE',250000,'PICTURE',250,1)
INSERT INTO friendbook_comment
VALUES('GREAT COFFEE',260000,'VIDEO',260,2)
INSERT INTO friendbook_comment
VALUES('SMILE ALWAYS',270000,'PICTURE',270,4)
INSERT INTO friendbook_comment
VALUES('ALL THAT GLITTERS IS NOT GOLD',280000,'STATUS',280,3)
INSERT INTO friendbook_comment
VALUES('UPS AND DOWNS IN LIFE',290000,'STATUS',290,6)
INSERT INTO friendbook_comment
VALUES('UNCONSCIOUS',300000,'VIDEO',300,11)
INSERT INTO friendbook_comment
VALUES('ENJOYING TIME',310000,'VIDEO',310,13)
INSERT INTO friendbook_comment
VALUES('FAVOURITE HOBBY',320000,'VIDEO',320,15)
INSERT INTO friendbook_comment
VALUES('DOG IS VERY FAITHFUL',330000,'VIDEO',330,12)
INSERT INTO friendbook_comment
VALUES('MY CHILDHOOD',340000,'VIDEO',340,13)
INSERT INTO friendbook_comment
VALUES('LEARNING MYSQL',350000,'STATUS',350,15)
INSERT INTO friendbook_comment
VALUES('ARIJIT SINGH ROCKS!!',360000,'VIDEO',360,13)
INSERT INTO friendbook_comment
VALUES('MUST WATCH',370000,'VIDEO',370,15)
INSERT INTO friendbook_comment
VALUES('BEAUTIFULLY DECORATTED',380000,'VIDEO',380,13)
INSERT INTO friendbook_comment
VALUES('SAFEST PLACE',390000,'STATUS',390,15)
INSERT INTO friendbook_comment
VALUES('I HATE NERDS',400000,'PICTURE',400,20)
INSERT INTO friendbook_comment
VALUES('LAUGHING OUT LOUD',410000,'STATUS',410,20)
INSERT INTO friendbook_comment
VALUES('HI!',420000,'PICTURE',420,2)
INSERT INTO friendbook_comment
VALUES('FOR BUSINESS TRIPS!!',430000,'STATUS',430,13)
INSERT INTO friendbook_comment
VALUES('LOVING WIFE!!!',440000,'PICTURE',440,12)
INSERT INTO friendbook_comment
VALUES('MEETING??',450000,'STATUS',450,12)
INSERT INTO friendbook_comment
VALUES('STUPID EXCUSE',460000,'STATUS',460,12)
INSERT INTO friendbook_comment
VALUES('EXCELLENT',470000,'STATUS',470,12)
INSERT INTO friendbook_comment
VALUES('CANNOT BE BROUGHT FROM MONEY!',480000,'VIDEO',160,12)
INSERT INTO friendbook_comment
VALUES('TIME CHANGES!',490000,'VIDEO',160,16)
INSERT INTO friendbook_comment
VALUES('LOTS OF LOVE!',500000,'VIDEO',160,16)
INSERT INTO friendbook_comment
VALUES('CANNOT BE BROUGHT BY RICH!',510000,'VIDEO',160,16)

/* UPDATE  DATE COLUMN  IN POST AND COMMENT */
ALTER TABLE friendbook_sizepost
ADD DATES VARCHAR(20)

UPDATE friendbook_sizepost
SET DATES='10/09/14'
WHERE LEN(POST) <= 10
UPDATE friendbook_sizepost
SET DATES='11/09/14'
WHERE LEN(POST) > 10

ALTER TABLE friendbook_comment
ADD DATEC VARCHAR(20)

UPDATE friendbook_comment
SET DATEC='14/09/14'
WHERE LEN(COMMENT) <= 10
UPDATE friendbook_comment
SET DATEC='13/09/14'
WHERE LEN(COMMENT) > 10

/*QUERY 14 */

SELECT TOP 3 A.NAME
FROM friendbook_comment C,friendbook_sizepost B,friendbook_author A
WHERE A.ID= B.AUTHOR AND B.ID=C.POST AND A.COUNTRY='USA' 
AND C.POST IN(
SELECT  TOP 5 B.ID
FROM friendbook_author A,friendbook_sizepost B
WHERE A.ID=B.AUTHOR AND A.GENDER='FEMALE' AND A.CITY='CANADA' 
GROUP BY A.ID,B.ID)
GROUP BY A.NAME


 